# Duo-Nan-Guo å¤šé›£é

> èªè¨€æª¢å®šè€ƒè©¦å°æˆ°æ‡‰ç”¨ â€” çµåˆ Kahoot å¼å³æ™‚å°æˆ°èˆ‡ JLPT / TOEIC / TOPIK / HSK å®˜æ–¹é¡Œå‹

[![Next.js](https://img.shields.io/badge/Next.js-15-black?logo=next.js)](https://nextjs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5-blue?logo=typescript)](https://www.typescriptlang.org/)
[![Prisma](https://img.shields.io/badge/Prisma-6-2D3748?logo=prisma)](https://www.prisma.io/)
[![Pusher](https://img.shields.io/badge/Pusher-Realtime-blueviolet?logo=pusher)](https://pusher.com/)

---

## ğŸ“– ç›®éŒ„

- [å°ˆæ¡ˆæ¦‚è¿°](#å°ˆæ¡ˆæ¦‚è¿°)
- [åŠŸèƒ½ç‰¹è‰²](#åŠŸèƒ½ç‰¹è‰²)
- [æŠ€è¡“æ¶æ§‹](#æŠ€è¡“æ¶æ§‹)
- [å¿«é€Ÿé–‹å§‹](#å¿«é€Ÿé–‹å§‹)
- [ç’°å¢ƒè®Šæ•¸è¨­å®š](#ç’°å¢ƒè®Šæ•¸è¨­å®š)
- [å¯ç”¨æŒ‡ä»¤](#å¯ç”¨æŒ‡ä»¤)
- [å°ˆæ¡ˆçµæ§‹](#å°ˆæ¡ˆçµæ§‹)
- [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)
- [é–‹ç™¼æ–‡ä»¶](#é–‹ç™¼æ–‡ä»¶)

---

## å°ˆæ¡ˆæ¦‚è¿°

**Duo-Nan-Guo** æ˜¯ä¸€æ¬¾èªè¨€æª¢å®šè€ƒè©¦å°æˆ° PWA æ‡‰ç”¨ï¼Œç©å®¶å¯é€é 1v1 æˆ–å¤šäººå°æˆ°æ¨¡å¼ç·´ç¿’èªè¨€è€ƒè©¦é¡Œç›®ã€‚

| è€ƒè©¦é¡å‹ | èªè¨€ | ç­‰ç´š |
|----------|------|------|
| JLPT | æ—¥èª ğŸ‡¯ğŸ‡µ | N5 â†’ N1 |
| TOEIC | è‹±èª ğŸ‡ºğŸ‡¸ | æ©˜è‰² â†’ é‡‘è‰²è­‰æ›¸ |
| TOPIK | éŸ“èª ğŸ‡°ğŸ‡· | I 1ê¸‰ â†’ II 6ê¸‰ |
| HSK | ä¸­æ–‡ ğŸ‡¨ğŸ‡³ | 1ç´š â†’ 6ç´š |

---

## åŠŸèƒ½ç‰¹è‰²

### ğŸ® éŠæˆ²æ¨¡å¼
- **Bot å°æˆ°**ï¼šèˆ‡ LLM é©…å‹•çš„ AI å°æ‰‹å°æ±ºï¼ˆGPT-4o-miniã€Geminiã€Llama ç­‰ï¼‰
- **PvP å°æˆ°**ï¼šå³æ™‚ 1v1 çœŸäººå°æ±º
- **å¤šäººæ¨¡å¼**ï¼š2-8 äººåŒæ™‚ç«¶è³½ï¼ˆé–‹ç™¼ä¸­ï¼‰

### ğŸ“Š éŠæˆ²æ©Ÿåˆ¶
| æ©Ÿåˆ¶ | èªªæ˜ |
|------|------|
| åŸºç¤åˆ† | ç­”å° +100 åˆ† |
| é€Ÿåº¦çå‹µ | æœ€å¤š +50 åˆ†ï¼ˆç­”é¡Œè¶Šå¿«åˆ†æ•¸è¶Šé«˜ï¼‰ |
| é€£çºŒæ­£ç¢º | 1.0x â†’ 1.5x å€ç‡åŠ æˆ |
| å³æ™‚å›é¥‹ | é»æ“Šå¾Œç«‹å³é¡¯ç¤ºå°éŒ¯ï¼ˆClient-side Hash é©—è­‰ï¼‰ |

### ğŸ¤– AI å°æ‰‹
| Bot é¡å‹ | èªªæ˜ |
|----------|------|
| GPT-4o-mini | OpenAI æœ€å¿«æ¨¡å‹ |
| Gemini Flash | Google é«˜é€Ÿæ¨¡å‹ |
| Llama 3.3 70B | Groq æ¨ç†åŠ é€Ÿ |

### ğŸ“ˆ å…¶ä»–åŠŸèƒ½
- **æ­·å²ç´€éŒ„**ï¼šæŸ¥çœ‹éå»å°æˆ°çµæœèˆ‡ç­”é¡Œè©³æƒ…
- **æ’è¡Œæ¦œ**ï¼šå…¨æœç©å®¶ç©åˆ†æ’å
- **Google ç™»å…¥**ï¼šOAuth 2.0 å¿«é€Ÿç™»å…¥

---

## æŠ€è¡“æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Frontend                             â”‚
â”‚  Next.js 15 (App Router) + React 19 + Tailwind CSS 4        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Backend / API                           â”‚
â”‚  Next.js Server Actions + API Routes                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ NextAuth.js â”‚  â”‚ Prisma ORM  â”‚  â”‚ Vercel AI   â”‚          â”‚
â”‚  â”‚  (OAuth)    â”‚  â”‚ (MongoDB)   â”‚  â”‚    SDK      â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼                   â–¼                   â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  MongoDB    â”‚     â”‚   Pusher    â”‚     â”‚   LLM APIs  â”‚
   â”‚   Atlas     â”‚     â”‚  (Realtime) â”‚     â”‚ Gemini/GPT  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| å±¤ç´š | æŠ€è¡“ |
|------|------|
| Framework | Next.js 15 (App Router, Server Actions) |
| UI | React 19, Tailwind CSS 4, Framer Motion |
| Database | MongoDB Atlas + Prisma 6 |
| Auth | NextAuth.js 4 (Google OAuth) |
| Realtime | Pusher Channels |
| AI | Vercel AI SDK (Gemini, OpenAI, Groq) |
| Deployment | Vercel |

---

## å¿«é€Ÿé–‹å§‹

### ç’°å¢ƒéœ€æ±‚

- **Node.js** 20+
- **pnpm** 9+
- **MongoDB Atlas** å¸³è™Ÿ
- **Pusher** å¸³è™Ÿ
- **Google Cloud** OAuth æ†‘è­‰
- **AI API Key**ï¼ˆè‡³å°‘ä¸€å€‹ï¼šGemini / OpenAI / Groqï¼‰

### å®‰è£æ­¥é©Ÿ

```bash
# 1. Clone å°ˆæ¡ˆ
git clone https://github.com/RiceTooCold/duo-nan-guo.git
cd duo-nan-guo

# 2. å®‰è£ä¾è³´
pnpm install

# 3. è¨­å®šç’°å¢ƒè®Šæ•¸
cp .env.example .env
# ç·¨è¼¯ .env å¡«å…¥æ‰€æœ‰å¿…è¦è®Šæ•¸ï¼ˆè¦‹ä¸‹æ–¹èªªæ˜ï¼‰

# 4. æ¨é€ Schema åˆ°è³‡æ–™åº«
pnpm db:push

# 5. Seed Bot ä½¿ç”¨è€…ï¼ˆå»ºç«‹ AI å°æ‰‹å¸³è™Ÿï¼‰
pnpm seed-bots

# 6. å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨
pnpm dev
```

é–‹å•Ÿ [http://localhost:3000](http://localhost:3000) å³å¯ä½¿ç”¨ã€‚

---

## ç’°å¢ƒè®Šæ•¸è¨­å®š

å°‡ `.env.example` è¤‡è£½ç‚º `.env` ä¸¦å¡«å…¥ä»¥ä¸‹è®Šæ•¸ï¼š

### å¿…å¡«

| è®Šæ•¸ | èªªæ˜ | å–å¾—æ–¹å¼ |
|------|------|----------|
| `DATABASE_URL` | MongoDB é€£ç·šå­—ä¸² | [MongoDB Atlas](https://www.mongodb.com/cloud/atlas) |
| `NEXTAUTH_SECRET` | NextAuth åŠ å¯†é‡‘é‘° | `openssl rand -base64 32` |
| `NEXTAUTH_URL` | æ‡‰ç”¨ç¨‹å¼ URL | `http://localhost:3000` (é–‹ç™¼) |
| `GOOGLE_CLIENT_ID` | Google OAuth Client ID | [Google Cloud Console](https://console.cloud.google.com/apis/credentials) |
| `GOOGLE_CLIENT_SECRET` | Google OAuth Secret | åŒä¸Š |
| `PUSHER_APP_ID` | Pusher App ID | [Pusher Dashboard](https://dashboard.pusher.com/) |
| `PUSHER_KEY` | Pusher Key | åŒä¸Š |
| `PUSHER_SECRET` | Pusher Secret | åŒä¸Š |
| `PUSHER_CLUSTER` | Pusher Cluster | é€šå¸¸ç‚º `ap3` |
| `NEXT_PUBLIC_PUSHER_KEY` | åŒ `PUSHER_KEY` | å‰ç«¯ä½¿ç”¨ |
| `NEXT_PUBLIC_PUSHER_CLUSTER` | åŒ `PUSHER_CLUSTER` | å‰ç«¯ä½¿ç”¨ |

### AI API Keysï¼ˆè‡³å°‘å¡«ä¸€å€‹ï¼‰

| è®Šæ•¸ | èªªæ˜ | å–å¾—æ–¹å¼ |
|------|------|----------|
| `GEMINI_API_KEY` | Google Gemini | [AI Studio](https://aistudio.google.com/app/apikey) |
| `OPENAI_API_KEY` | OpenAI | [OpenAI Platform](https://platform.openai.com/api-keys) |
| `GROQ_API_KEY` | Groq | [Groq Console](https://console.groq.com/keys) |

### é¸å¡«

| è®Šæ•¸ | èªªæ˜ | é è¨­å€¼ |
|------|------|--------|
| `NEXT_PUBLIC_ADMIN_PASSWORD` | Admin é é¢å¯†ç¢¼ | - |
| `CRON_SECRET` | Vercel Cron æˆæ¬Šé‡‘é‘° | - |
| `GEMINI_RPM` | Gemini API é€Ÿç‡é™åˆ¶ | `30` |

---

## å¯ç”¨æŒ‡ä»¤

| æŒ‡ä»¤ | èªªæ˜ |
|------|------|
| `pnpm dev` | å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨ |
| `pnpm build` | å»ºç½®ç”Ÿç”¢ç‰ˆæœ¬ |
| `pnpm start` | å•Ÿå‹•ç”Ÿç”¢ä¼ºæœå™¨ |
| `pnpm lint` | åŸ·è¡Œ ESLint |
| `pnpm db:generate` | ç”Ÿæˆ Prisma Client |
| `pnpm db:push` | æ¨é€ Schema åˆ°è³‡æ–™åº« |
| `pnpm db:studio` | é–‹å•Ÿ Prisma Studioï¼ˆè³‡æ–™åº« GUIï¼‰ |
| `pnpm seed-bots` | å»ºç«‹ AI Bot ä½¿ç”¨è€… |

---

## å°ˆæ¡ˆçµæ§‹

```
duo-nan-guo/
â”œâ”€â”€ app/                       # Next.js App Router
â”‚   â”œâ”€â”€ (game)/               # éŠæˆ²é é¢ï¼ˆéœ€ç™»å…¥ï¼‰
â”‚   â”‚   â”œâ”€â”€ battle/           # å°æˆ°é é¢
â”‚   â”‚   â”œâ”€â”€ history/          # æ­·å²ç´€éŒ„
â”‚   â”‚   â”œâ”€â”€ leaderboard/      # æ’è¡Œæ¦œ
â”‚   â”‚   â”œâ”€â”€ lobby/            # å¤§å»³
â”‚   â”‚   â”œâ”€â”€ results/          # çµç®—é é¢
â”‚   â”‚   â””â”€â”€ room/             # ç­‰å¾…å®¤
â”‚   â”œâ”€â”€ admin/                # é¡Œç›®ç®¡ç†å¾Œå°
â”‚   â”œâ”€â”€ api/                  # API Routes
â”‚   â”‚   â”œâ”€â”€ auth/             # NextAuth ç«¯é»
â”‚   â”‚   â””â”€â”€ cron/             # å®šæ™‚ä»»å‹™
â”‚   â””â”€â”€ login/                # ç™»å…¥é é¢
â”‚
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ factory/              # é¡Œç›®ç”Ÿæˆé‚è¼¯
â”‚   â”‚   â”œâ”€â”€ ai/               # AI æ¨¡å‹æ•´åˆ
â”‚   â”‚   â””â”€â”€ services/         # ç”Ÿæˆæœå‹™
â”‚   â”œâ”€â”€ game-engine/          # éŠæˆ²å¼•æ“
â”‚   â”‚   â”œâ”€â”€ server/           # Server-side ç‹€æ…‹ç®¡ç†
â”‚   â”‚   â””â”€â”€ useGameClient.ts  # Client-side Hook
â”‚   â”œâ”€â”€ config/               # éŠæˆ²è¨­å®š
â”‚   â”œâ”€â”€ auth.ts               # NextAuth è¨­å®š
â”‚   â”œâ”€â”€ prisma.ts             # Prisma Client
â”‚   â””â”€â”€ pusher.ts             # Pusher è¨­å®š
â”‚
â”œâ”€â”€ actions/                   # Server Actions
â”‚   â”œâ”€â”€ game.server.ts        # éŠæˆ²ç›¸é—œ
â”‚   â”œâ”€â”€ bot.server.ts         # Bot AI å‘¼å«
â”‚   â””â”€â”€ leaderboard.server.ts # æ’è¡Œæ¦œ
â”‚
â”œâ”€â”€ components/               # React å…ƒä»¶
â”‚   â””â”€â”€ game/                 # éŠæˆ² UI å…ƒä»¶
â”‚
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma         # è³‡æ–™åº« Schema
â”‚   â””â”€â”€ seed-bots.ts          # Bot ä½¿ç”¨è€… Seed
â”‚
â””â”€â”€ docs/                     # å°ˆæ¡ˆæ–‡ä»¶
```

---

## éƒ¨ç½²æŒ‡å—

### Vercel éƒ¨ç½²

1. **é€£çµ GitHub Repository**
   - ç™»å…¥ [Vercel](https://vercel.com/)
   - Import å°ˆæ¡ˆ

2. **è¨­å®šç’°å¢ƒè®Šæ•¸**
   - åœ¨ Vercel Dashboard â†’ Settings â†’ Environment Variables
   - åŠ å…¥æ‰€æœ‰[å¿…å¡«ç’°å¢ƒè®Šæ•¸](#ç’°å¢ƒè®Šæ•¸è¨­å®š)
   - `NEXTAUTH_URL` è¨­ç‚ºä½ çš„ Vercel ç¶²åŸŸï¼ˆå¦‚ `https://duo-nan-guo.vercel.app`ï¼‰

3. **è¨­å®š Cron Jobï¼ˆé¸å¡«ï¼‰**
   - `vercel.json` å·²è¨­å®šæ¯æ—¥ 10:00 UTC åŸ·è¡Œæ¸…ç†ä»»å‹™
   - åœ¨ Vercel è¨­å®š `CRON_SECRET` ç’°å¢ƒè®Šæ•¸

4. **éƒ¨ç½²**
   - Push åˆ° `main` åˆ†æ”¯å³è‡ªå‹•éƒ¨ç½²

### æ³¨æ„äº‹é …

- Vercel Hobby Plan æœ‰ **10 ç§’** å‡½æ•¸åŸ·è¡Œé™åˆ¶
- æœ¬å°ˆæ¡ˆå·²é‡å° Serverless å„ªåŒ–ï¼š
  - Client-side Hash é©—è­‰å¯¦ç¾å³æ™‚å›é¥‹
  - LLM å‘¼å«æœ‰ 5 ç§’ Timeout + Fallback
  - Client-driven è½‰å ´é¿å…èƒŒæ™¯åŸ·è¡Œ

---

## é–‹ç™¼æ–‡ä»¶

- [æ•´é«”è¦æ ¼æ›¸](./docs/overall-spec.md)
- [é¡Œç›®å·¥å» è¦æ ¼](./docs/factory/Duo-Nan-Guo%20Factory%20Specification.md)
- [å”ä½œèˆ‡ Git Flow](./docs/collaboration-and-gitflow.md)

---

## License

MIT Â© 2025 Duo-Nan-Guo Team
